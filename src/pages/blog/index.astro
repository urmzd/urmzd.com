---
import BaseLayout from "@/layouts/BaseLayout.astro";
import { getCollection } from "astro:content";

const posts = await getCollection("blog");
const sortedPosts = posts.sort(
  (a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf()
);
---

<BaseLayout title="Blog - urmzd">
  <main class="container mx-auto px-4 pt-24 pb-16">
    <h1 class="mb-8 text-4xl font-bold">Blog</h1>

    {
      sortedPosts.length === 0 ? (
        <p class="text-muted-foreground">No posts yet. Check back soon!</p>
      ) : (
        <ul class="space-y-6">
          {sortedPosts.map((post) => (
            <li>
              <a
                href={`/blog/${post.id}`}
                class="group block rounded-lg border border-border p-6 transition-colors hover:border-primary"
              >
                <h2 class="text-2xl font-semibold group-hover:text-primary">
                  {post.data.title}
                </h2>
                <p class="mt-2 text-muted-foreground">{post.data.description}</p>
                <time class="mt-4 block text-sm text-muted-foreground">
                  {post.data.pubDate.toLocaleDateString("en-US", {
                    year: "numeric",
                    month: "long",
                    day: "numeric",
                  })}
                </time>
              </a>
            </li>
          ))}
        </ul>
      )
    }
  </main>
</BaseLayout>
